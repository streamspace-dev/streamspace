# Default values for workspace-platform

# Controller configuration
controller:
  image:
    repository: your-registry/workspace-controller
    tag: latest
    pullPolicy: IfNotPresent

  replicas: 1  # Increase to 2+ for HA (Phase 5)

  resources:
    requests:
      memory: 256Mi
      cpu: 200m
    limits:
      memory: 512Mi
      cpu: 500m

  config:
    # PostgreSQL connection
    postgres:
      host: postgres.data.svc.cluster.local
      port: 5432
      database: workspaces
      user: postgres
      # Password should be set in secrets

    # Authentik integration
    authentik:
      url: https://authentik.local
      issuer: https://authentik.local/application/o/workspaces/
      # Client secret should be set in secrets

    # Hibernation settings
    hibernation:
      enabled: true
      defaultIdleTimeout: 30m
      defaultMaxSessionDuration: 8h
      checkInterval: 60s

    # Resource settings
    resources:
      defaultMemory: 2Gi
      defaultCPU: 1000m
      maxMemory: 8Gi
      maxCPU: 4000m

    # Storage
    storage:
      className: nfs-client
      defaultHomeSize: 50Gi
      persistentHomeEnabled: true

    # Cluster capacity
    cluster:
      memoryThreshold: 85
      queueEnabled: true
      queueMaxWaitTime: 5m

    # Networking
    networking:
      ingressDomain: workspaces.local
      ingressClass: traefik

# API backend configuration
api:
  image:
    repository: your-registry/workspace-api
    tag: latest
    pullPolicy: IfNotPresent

  replicas: 2

  resources:
    requests:
      memory: 128Mi
      cpu: 100m
    limits:
      memory: 256Mi
      cpu: 500m

  config:
    jwtExpiration: 3600
    corsOrigins: https://workspaces.local
    metricsEnabled: true

# Web UI configuration
ui:
  image:
    repository: your-registry/workspace-ui
    tag: latest
    pullPolicy: IfNotPresent

  replicas: 2

  resources:
    requests:
      memory: 64Mi
      cpu: 50m
    limits:
      memory: 128Mi
      cpu: 200m

  config:
    appName: "Workspace Streaming Platform"
    defaultIdleTimeout: "30m"
    features:
      hibernation: true
      sessionRecording: false
      analytics: true

  service:
    type: LoadBalancer
    port: 80

# Ingress configuration
ingress:
  enabled: true
  className: traefik
  annotations:
    traefik.ingress.kubernetes.io/router.entrypoints: websecure
    traefik.ingress.kubernetes.io/router.tls: "true"
  hostname: workspaces.local
  tls:
    enabled: false
    secretName: workspace-platform-tls

# Monitoring configuration
monitoring:
  enabled: true
  serviceMonitor:
    enabled: true
  prometheusRule:
    enabled: true
  grafanaDashboard:
    enabled: true

# Database initialization
database:
  init:
    enabled: true
    # Uses existing PostgreSQL in data namespace

# Secrets (should be overridden)
secrets:
  postgresPassword: postgres  # CHANGE ME
  jwtSecret: CHANGE_ME_GENERATE_RANDOM_SECRET
  authentikClientSecret: CHANGE_ME_FROM_AUTHENTIK

# Initial workspace templates
templates:
  # Deploy starter templates by default
  browsers:
    - firefox
    - chromium
  productivity:
    - libreoffice
  development:
    - code-server
  design:
    - gimp
    - blender

# Global settings
nameOverride: ""
fullnameOverride: ""
namespaceOverride: workspaces
